<!DOCTYPE html>
<html>
<head>
	<title>2.1 - 2.4</title>
	<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="styles.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<div class="scroll-post">
	<div class="panel">
		<div class="container">
			<iframe src="setup.html" width=720 height=640 frameborder=no></iframe>
		</div>
	</div>
	<div class="panel">
		<div class="container">
			<div class="header">
				<h1>Now Make a Prediction</h1>
				<h2>What's in this box?</h2>
			</div>
			<div class="content">
				<div id="prediction"></div>
				<div class="selection">
					<div id="selection1" style="background-color:#ED254B"></div>
					<div id="selection2" style="background-color:#C7FFD4"></div>
					<div id="selection3" style="background-color:#3FA9F5"></div>
					<div id="selection4" style="background-color:#FBC83B"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel">
		<div class="container">
			<!-- content here -->
		</div>
	</div>

</div>

<div class="status-bar">
	<div class="links">
		<div class="stage"><h3>Setup</h3><div class="circle-cue"></div></div>
		<div class="stage"><h3>Prediction</h3><div class="circle-cue"></div></div>
		<div class="stage"><h3>Results</h3><div class="circle-cue"></div></div>
	</div>
</div>

<script type="text/javascript" src=script1.js></script>
<script>

var scroll_post = document.querySelector('.scroll-post');
var panels = document.querySelector('.scroll-post').childNodes;
var stage = document.querySelector('.links').childNodes;
var stage1 = document.querySelector('.links').childNodes[1];
var stage2 = document.querySelector('.links').childNodes[3];
var stage3 = document.querySelector('.links').childNodes[5];

// setup stage
function stage_1() {
	// console.log("stage1")
	stage1.childNodes[0].style.visibility="visible";
	stage2.childNodes[0].style.visibility="hidden";
	stage3.childNodes[0].style.visibility="hidden";
	stage1.childNodes[1].style.backgroundColor="#ED574B";
	stage2.childNodes[1].style.backgroundColor="#CCCCCC";
	stage3.childNodes[1].style.backgroundColor="#CCCCCC";
}
// prediction stage
function stage_2() {
	// console.log("stage2")
	stage2.childNodes[0].style.visibility="visible";
	stage1.childNodes[0].style.visibility="hidden";
	stage3.childNodes[0].style.visibility="hidden";
	stage2.childNodes[1].style.backgroundColor="#ED574B";
	stage1.childNodes[1].style.backgroundColor="#CCCCCC";
	stage3.childNodes[1].style.backgroundColor="#CCCCCC";

}
// results stage
function stage_3() {
	// console.log("stage3")
	stage3.childNodes[0].style.visibility="visible";
	stage1.childNodes[0].style.visiblity="hidden";
	stage2.childNodes[0].style.visibility="hidden";
	stage3.childNodes[1].style.backgroundColor="#ED574B";
	stage1.childNodes[1].style.backgroundColor="#CCCCCC";
	stage2.childNodes[1].style.backgroundColor="#CCCCCC";
}

// random prediction setup
function prediction() {
	body = document.querySelector('#prediction')
	box = document.createElement('wide-custom-box');
	box.setAttribute("id", "pred_box")
	body.append(box);
	lid = document.createElement('lid');
	lid.setAttribute("class","lid");
	label = document.createElement('h1');
	number = Math.floor((Math.random() * 2) + 1)
	label.innerHTML = number;
	target = document.querySelector('#pred_box');
	target.append(lid);
	target.append(label);
	ball = document.createElement('div');
	ball.setAttribute("class","ball");
	ball_colors = ["#ED254B", "#C0F0D5"];
	cube_colors = ["#3FA9F5", "#FBC83B"];
	ball_color = Math.floor((Math.random() * 2) + 0);
	ball.style.backgroundColor = ball_colors[ball_color];
	target.append(ball)
	cube = document.createElement('div');
	cube.setAttribute("class","cube");
	cube_color = Math.floor((Math.random() * 2) + 0);
	cube.style.backgroundColor = cube_colors[cube_color];
	target.append(cube);
}

stage_1();
prediction();

scroll_post.onscroll=function() {
	var w = scroll_post.scrollWidth;
	var w_loc = scroll_post.scrollLeft;
	var loc = w_loc/w

	if(loc < .15  ){
		stage_1();
	} else if (loc > .15 & loc < .30) {
		stage_2();
	} else if( loc > .30 & loc < .6) {
		stage_3();
	}
} 

var pred_selections = document.querySelector('.selection').childNodes;
var pred_sel_section = document.querySelector('.selection');
var selections = pred_sel_section.querySelectorAll('div');
var selection1 = pred_selections[1];
var selection2 = pred_selections[3];
var selection3 = pred_selections[5];
var selection4 = pred_selections[7];
var sel_ball;
var sel_square;
console.log(pred_selections);

for(i=0;i<selections.length;i++){
	selections[i].onclick=function() {
		var parent = this.parentNode;
		var circles = [1,3]
		var squares = [5,7]
		var ref;
		// The equivalent of parent.children.indexOf(child)
		var index = Array.prototype.indexOf.call(parent.children, this);
		if(index == 0){
			ref = 1;
		} else if (index==1) {
			ref = 3;
		} else if (index == 2){
			ref = 5;
		} else if (index == 3){
			ref =7
		}
		console.log(ref);
		var node = index+1;
		var color = document.querySelector("#selection"+node).style.backgroundColor;

		if (index == 0 | index == 1) {
			sel_ball = this.id;
			circles.forEach(function(i) {
			    pred_selections[i].style.width="3em";
				pred_selections[i].style.height="3em";
				pred_selections[i].style.boxShadow="";
			});
		} else if (index == 2 | index == 3) {
			sel_square = this.id;
			squares.forEach(function(i) {
			    pred_selections[i].style.width="3em";
				pred_selections[i].style.height="3em";
				pred_selections[i].style.boxShadow="";
			});
		}

		pred_selections[ref].style.width="4em";
		pred_selections[ref].style.height="4em";
		pred_selections[ref].style.boxShadow="0.2em 0.2em 2em " + color;

	}
}





</script>

</body>
</html>