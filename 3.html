<!DOCTYPE html>
<html>
<head>
	<title>Simulation</title>
	<link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800" rel="stylesheet">
	<script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
	<link rel="stylesheet" type="text/css" href="styles.css">
</head>
<style>
body, html {
	margin:0;
	top:0;
	left:0;
	font-family:'Nunito Sans', sans-serif;
}
prediction p {
	display:inline-block;
	margin-right:2%;
}
prediction select {
	display:inline-block;
	margin-right:2%;
}
select {
	border-radius:50%;
	border:0;
	background-color:#E6E6E6;
	height:5vh;
	width:10%;
	cursor:pointer;
}
select:focus {
	outline:0;
}
.center-full-div {
	margin-top:0%;
}
.header {
	margin-top:0%;
	margin-bottom:5%;
}
.header h1 {
	text-align:center;
}
.header h2 {
	text-transform:none;
	letter-spacing:0em;
	text-align:center;
	line-height:1.2em;
}
#single{
	margin-top:5%;
}
.button {
	display:inline-block;
	margin-right:2%;
}

prediction p {
	font-weight:800;
	text-transform:uppercase;
	letter-spacing:0.05em;
	font-size:0.8em;
}

prediction .label {
	margin-right:3%;
	padding: 1% 3% 1% 3%;
}
.prediction_results {
	z-index:100;
	margin:auto;
	text-align:center;
	width:100%;
	height:100vh;
	background-color:white;
	position:absolute;
	display:none;
	animation:fadeIn 0.5s ease-in-out;
	color:#666666;
}
.prediction_results h2 {
	text-transform:uppercase;
	letter-spacing:0.05em;

}
.prediction_results h3 {
	font-weight:400;

}
.close {
	cursor:pointer;
}
.label {
	display:inline-block;
	border:0.1em solid #ED574B;;
	color:#ED574B;
	padding: 0.3% 0.5%;
	font-size:0.8em;
	vertical-align:middle;
	margin-right:0.5%;
	margin-left:0.5%;
}

.red, .green {
	display:inline-block;
	width:2em;
	height:2em;
	border-radius:50%;
	vertical-align:middle;
	margin-left:0.5%;
}
.red {
	background-color:#ED254B;
}
.green {
	background-color:#C7FFD4;
}
@media screen and (min-width:1920px){
	prediction {
		line-height:4em;
	}
}
</style>
<body>

<div class="prediction_results">
</div>

<div class="scroll-post">

<div class="panel">
<div class="container">

	<div class=header>
			<h1>Simulation</h1>
			<h2>Draw from a random box and apply the decision rule below. <br>How often are you correct?</h2>
		</div>

		<prediction>
			<p>Given</p>
				<div class=label>A</div>
			<p>predict</p>
				<select id="predict_ball1">
				  <option value="none">- select ball color -</option>
				  <option value="red">red</option>
				  <option value="green">green</option>
				</select>
			<br>
			<p>Given</p>
				<div class=label>B</div>
			<p>predict</p>
				<select id="predict_ball2">
				  <option value="none">- select ball color -</option>
				  <option value="red">red</option>
				  <option value="green">green</option>
				</select>
			<br>
			<p>Given</p>
				<div class=label>C</div>
			<p>predict</p>
				<select id="predict_ball3">
				  <option value="none">- select ball color -</option>
				  <option value="red">red</option>
				  <option value="green">green</option>
				</select>
		</prediction>
		<br>

		<div class="button" id="single">Run 1x</div>
		<div class="button" id="hundred">Run 100x</div>
		</div>
	</div>
</div>
<script>

var random_draw=[];
randomDraw();
console.log(random_draw);

function randomDraw(){
		ball_colors = ["red", "green"]; //red,green: "#ED254B", "#C7FFD4"
		cube_colors = ["blue", "yellow"]; //blue, yellow: "#3FA9F5", "#FBC83B"
		for(i=1;i<7;i++){
			var ball_assignment = Math.floor((Math.random() * 2) + 0);
			var cube_assignment = Math.floor((Math.random() * 2) + 0);
			var ball_color = ball_colors[ball_assignment];
			var cube_color= cube_colors[cube_assignment];
			var label = Math.floor((Math.random() * 3) + 1);
			if(label == 1 ){
				label="A";
			} else if(label == 2){
				label = "B"
			} else {
				label = "C";
			}
			random_draw.push({
				label: label,
				ball: ball_color,
				cube: cube_color
			});
		}
	}

// activate button when prediction is made
label1 = document.querySelector('#given_label1');
label2 = document.querySelector('#given_label2');
label3 = document.querySelector('#given_label3');
predict1 = document.querySelector("#predict_ball1");
predict2 = document.querySelector("#predict_ball2");
predict3 = document.querySelector("#predict_ball3");
select = document.querySelectorAll("select");
single = document.querySelector('#single');
hundred = document.querySelector('#hundred');
format = d3.format(".0%");
prediction_results = document.querySelector('.prediction_results')
var results = [];
var error_rate;
var val1;
var val2;
var val3;
var times_ran;

single.onclick=function() {
	console.log(this.value);
		// check if predict1 and predict2 are checked
		if(predict1.value != "none" && predict2.value != "none" && predict3.value != "none"){
			// values for predict1 and predict2
			val1 = predict1.value;
			val2 = predict2.value;
			val3 = predict3.value;
			console.log(val1 +", "+val2 + "," + val3)
			// error rate based on applying relevant decision rule
			results = [];
			// draw a random box once from the randomDraw crate 
				random_box= Math.floor((Math.random() * 6) + 0);
				drawn_label = random_draw[random_box]['label'];
				drawn_ball = random_draw[random_box]['ball'];
				if(drawn_label=="A"){
					if(predict1.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				} else if (drawn_label=="B"){
					if(predict2.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				} else {
					if(predict3.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				}
			console.log(results);
			false_results = results.filter(function(d){return d=="false"}).length
			console.log("number false predicionts: "+ false_results);
			console.log("total predictions made: "+results.length)
			error_rate=false_results/results.length;
			console.log("error: "+error_rate);

			var single_result;
			if(error_rate == 0){
				single_result = "Correct";
			} else {
				single_result = "Incorrect"
			}
			prediction_results.style.display="inline-block";
			prediction_results.innerHTML="<div class='header'><h1>" + single_result +"</h1><h2>Your prediction of <div class=label>A</div>:<div class="+val1+"></div> and <div class=label>B</div>:<div class="+val2+"></div> and <div class=label>C</div>:<div class="+val3+"></div> was " + single_result + "</h2></div><div class='button close'>Play Again</div>";
			close = document.querySelector('.close');
			close.onclick=function() {
			prediction_results.style.display="none";
			}

		} else {
		}
}

hundred.onclick=function() {
	console.log(this.value);
		// check if predict1 and predict2 are checked
		if(predict1.value != "none" && predict2.value != "none" && predict3.value != "none"){
			// values for predict1 and predict2
			val1 = predict1.value;
			val2 = predict2.value;
			val3 = predict3.value;
			console.log(val1 +", "+val2 + "," + val3)
			// error rate based on applying relevant decision rule
			results = [];
			// draw a random box 100 times from the randomDraw crate 
			for(i=0;i<100;i++){
				random_box= Math.floor((Math.random() * 6) + 0);
				console.log(random_box)
				drawn_label = random_draw[random_box]['label'];
				drawn_ball = random_draw[random_box]['ball'];
				if(drawn_label=="A"){
					if(predict1.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				} else if (drawn_label=="B"){
					if(predict2.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				} else {
					if(predict3.value==drawn_ball){
						results.push("true");
					}else {
						results.push("false")
					}
				}
			}
			console.log(results);
			false_results = results.filter(function(d){return d=="false"}).length
			console.log("number false predicionts: "+ false_results);
			console.log("total predictions made: "+results.length)
			error_rate=false_results/results.length;
			console.log("error: "+error_rate);
			
			prediction_results.style.display="inline-block";
			prediction_results.innerHTML="<div class='header'><h1>Error rate: " + format(error_rate)+"</h1><h2>Your prediction of <div class=label>A</div>:<div class="+val1+"></div> and <div class=label>B</div>:<div class="+val2+"></div> and <div class=label>C</div>:<div class="+val3+"></div> was inaccurate "+ false_results + " times out of 100" +"</h2></div><div class='button close'>Play Again</div>";
			close = document.querySelector('.close');
			close.onclick=function() {
			prediction_results.style.display="none";
			}

		} else {
		}
}

</script>
</body>

</html>